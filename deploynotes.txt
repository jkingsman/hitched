sudo apt-get update -y
sudo apt-get install -y software-properties-common nginx python3-pip
sudo add-apt-repository -y ppa:certbot/certbot
sudo apt-get update -y
sudo apt-get install -y python-certbot-nginx

sudo sed -i "s/Port 22/Port 2222/" /etc/ssh/sshd_config
sudo service sshd restart

sudo chown -R $USER:$USER /srv
cd /srv

git clone https://github.com/jkingsman/hitched.git
cd hitched

pip3 install -r app/requirements.txt


sudo cp app/nginx.conf /etc/nginx/sites-available/hitched
sudo ln -s /etc/nginx/sites-available/hitched /etc/nginx/sites-enabled
sudo nginx -t
sudo systemctl restart nginx	


sudo service sshd restart
 sudo service nginx start
 sudo yum install python35 python35-devel python35-pip python35-setuptools python35-virtualenv
 cd hitched
sudo pip-3.5 install -r requirements.txt
sudo pip-3.5 install -r app/requirements.txt
 sudo vim /etc/nginx/nginx.conf

 call launch_gunicorn from app and background it
 sudo ./certbot-auto --webroot --webroot-path /srv/hitched/static certonly --no-bootstrap
sudo ./certbot-auto renew --webroot --webroot-path /srv/hitched/static --no-bootstrap


sudo apt-get install supervisor
sudo cp app/gunicorn_supervisord.conf /etc/supervisor/conf.d/gunicorn_supervisord.conf

sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl status
